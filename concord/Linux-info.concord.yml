flows:
  LinuxInfo:
    - checkpoint: "Start"
    - checkpoint: "User Input"
    - form: linux_server
    - checkpoint: "Run Playbook"
    - call: teams
    - task: ansible
      in:
        config:
          defaults:
            forks: 50
          ssh_connection:
            pipelining: True
        auth:
          privateKey:
            user: concord-server
            secret:
              org: "Samuel_Testing"
              name: Azure
        playbook: playbook/Linux_Info.yml
        inventoryFile: inventory.ini
        extraVars:
          target_hosts: ${linux_server.target}
      out: playbookResult
    - if: "${playbookResult.ok}"
      then:
        - task: msteams
          in:
            text: "The playbook execution was successful."
            replyToId: "${messageId}"
            ignoreErrors: true
      else:
        - task: msteams
          in:
            title: "Playbook Execution Completed With Errors"
            text: "The playbook execution failed."
            replyToId: "${messageId}"
            ignoreErrors: true
