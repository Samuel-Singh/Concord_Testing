flows:
  teams:
    - task: msteams
      in:
        action: sendMessage
        webhookUrl: ${teamsWebhookUrl}
        title: "A Concord process has been started"
        text: |
          Playbook has been initiated.
          [Concord Link](${concordProcess})
        ignoreErrors: true
      out: result
    - if: "${!result.ok}"
      then:
        - throw: "Error while sending a message: ${result.error}"
      else:
        - log: "Data: ${result.data}"

  teamSuccess:
    - task: msteams
      in:
          action: replyToConversation
          conversationId: ${result.conversationId}
          text: |
            The playbook execution succeeded.
            [Concord Link](${concordProcess})

  teamFailure:
    - task: msteams
      in:
          action: replyToConversation
          conversationId: ${result.conversationId}
          text: |
            The playbook execution failed.
            [Concord Link](${concordProcess})
