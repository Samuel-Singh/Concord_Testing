flows:
  teams:
    - task: msteams
      in:
        action: sendMessage
        webhookUrl: ${teamsWebhookUrl}
        title: "A Concord process has been started"
        text: |
          Playbook has been initiated.
          [Concord Link](${concordProcess})
        ignoreErrors: true
      out: result
    - if: "${!result.ok}"
      then:
        - throw: "Error while sending a message: ${result.error}"
      else:
        - log: "Data: ${result.data}"
        - log: "Result: ${result}"
        - set: 
            messageId: "${result.data.id}"

  teamSuccess:
    - task: msteams
      in:
          action: sendMessage
          webhookUrl: ${teamsWebhookUrl}
          title: "Playbook Execution Completed"
          text: |
            The playbook execution was successful.
            [Concord Link](${concordProcess})
          replyToId: "${messageId}"
          ignoreErrors: true

  teamFailure:
    - task: msteams
      in:
          action: sendMessage
          webhookUrl: ${teamsWebhookUrl}
          title: "Playbook Execution Completed With Failure"
          text: |
            The playbook execution failed.
            [Concord Link](${concordProcess})
          replyToId: "${messageId}"
          ignoreErrors: true
